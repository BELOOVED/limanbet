(self.webpackChunkfenrir=self.webpackChunkfenrir||[]).push([[829],{91829:function(e,s,t){"use strict";t.r(s),t.d(s,{MessagesModule:function(){return Q}});var n=t(6778),i=t(97296),a=t(16617),c=t(77296),r=t(76857),g=t(58862),o=t(30321),d=t(72643),m=t(46627),l=t(7035),u=t(46583),h=t(98995);function f(e,s){1&e&&(d.TgZ(0,"div",10),d._UZ(1,"div",11),d.qZA())}function p(e,s){if(1&e&&(d._UZ(0,"h5",20),d.ALo(1,"stripHtml")),2&e){const e=d.oxw().$implicit;d.Q6J("innerHTML",d.lcZ(1,1,e.subject),d.oJD)}}function Z(e,s){if(1&e&&(d._UZ(0,"p",21),d.ALo(1,"stripHtml")),2&e){const e=d.oxw().$implicit;d.Q6J("innerHTML",d.lcZ(1,1,e.body),d.oJD)}}const M=function(e,s){return{actived:e,unread:s}};function L(e,s){if(1&e){const e=d.EpF();d.TgZ(0,"div",14),d.TgZ(1,"a",15),d.NdJ("click",function(s){const t=d.CHM(e).$implicit;return d.oxw(2).markAsDelete(t.customerMessageId,s)}),d._UZ(2,"i",16),d.qZA(),d.YNc(3,p,2,3,"h5",17),d.YNc(4,Z,2,3,"p",18),d.TgZ(5,"div",19),d._uU(6),d.ALo(7,"date"),d.qZA(),d.qZA()}if(2&e){const e=s.$implicit,t=d.oxw(2);d.Q6J("ngClass",d.WLB(7,M,e.customerMessageId===t.selectedMessage.customerMessageId,!e.read))("routerLink","/"+t.currentLang+"/messages/"+e.customerMessageId),d.xp6(3),d.Q6J("ngIf",e.subject),d.xp6(1),d.Q6J("ngIf",e.body),d.xp6(2),d.hij(" ",d.lcZ(7,5,e.sendDate)," ")}}function A(e,s){if(1&e&&(d.TgZ(0,"div",12),d.YNc(1,L,8,10,"div",13),d.qZA()),2&e){const e=d.oxw();d.xp6(1),d.Q6J("ngForOf",e.messageList)}}function v(e,s){if(1&e&&(d._UZ(0,"h5",25),d.ALo(1,"safeHtml")),2&e){const e=d.oxw(3);d.Q6J("innerHTML",d.lcZ(1,1,e.selectedMessage.subject),d.oJD)}}function T(e,s){if(1&e&&(d._UZ(0,"p",25),d.ALo(1,"safeHtml")),2&e){const e=d.oxw(3);d.Q6J("innerHTML",d.lcZ(1,1,e.selectedMessage.body),d.oJD)}}function I(e,s){if(1&e&&(d.TgZ(0,"div"),d.YNc(1,v,2,3,"h5",24),d.YNc(2,T,2,3,"p",24),d.TgZ(3,"div",19),d._uU(4),d.ALo(5,"date"),d.qZA(),d.qZA()),2&e){const e=d.oxw(2);d.xp6(1),d.Q6J("ngIf",e.selectedMessage.subject),d.xp6(1),d.Q6J("ngIf",e.selectedMessage.body),d.xp6(2),d.hij(" ",d.lcZ(5,3,e.selectedMessage.sendDate)," ")}}function x(e,s){if(1&e&&(d.TgZ(0,"div",22),d.YNc(1,I,6,5,"div",23),d.qZA()),2&e){const e=d.oxw();d.xp6(1),d.Q6J("ngIf",!!e.selectedMessage)}}function J(e,s){1&e&&(d.TgZ(0,"div",26),d._UZ(1,"message-box",27),d.ALo(2,"translate"),d.qZA()),2&e&&(d.xp6(1),d.s9C("content",d.lcZ(2,1,"MESSAGES.CUSTOMER_MESSAGE_NOT_FOUND")))}a.N.map.messageDetail;class S{constructor(e,s,t,n){this.messagesService=e,this.route=s,this.translateFactory=t,this.router=n,this.messageList=[],this.inProgress=!0,this.destroyed$=new r.xQ}ngOnInit(){this.currentLang=this.translateFactory.currentLang.code,this.getMessages()}getMessages(){this.messagesService.getMessages().then(e=>{if(this.inProgress=!1,this.messageList=(0,g.Z)(e,"sendDate","desc"),this.route.params.pipe((0,c.Rs)(this.destroyed$)).subscribe(e=>{this.messageList&&this.messageList.length&&e.msgId&&this.setSelectedMessage(e.msgId)}),this.route.snapshot.paramMap.get("msgId"))return!1;this.router.navigate(["/",this.currentLang,"messages",this.messageList[0].customerMessageId])}).catch(e=>{this.inProgress=!1})}markAsRead(e){this.messagesService.markAsRead(e).then(e=>{})}markAsDelete(e,s){s.preventDefault(),this.messagesService.markAsDelete(e).then(s=>{(0,o.Z)(this.messageList,s=>s.customerMessageId===e)})}setSelectedMessage(e){let s=this.messageList.find(s=>s.customerMessageId===Number(e));s||(s=this.messageList[0]),this.selectedMessage=s,this.selectedMessage&&!this.selectedMessage.read&&(s.read=!0,setTimeout(e=>{this.markAsRead(this.selectedMessage.customerMessageId)},200))}ngOnDestroy(){this.destroyed$.next(!0),this.destroyed$.complete()}}S.\u0275fac=function(e){return new(e||S)(d.Y36(i.Ry4),d.Y36(m.gz),d.Y36(i.chr),d.Y36(m.F0))},S.\u0275cmp=d.Xpm({type:S,selectors:[["messages"]],decls:12,vars:7,consts:[[1,"message-detail","container"],[1,"row"],[1,"modul-accordion"],[1,"modul-header"],[1,"header-text"],[1,"modul-content"],["class","progress",4,"ngIf"],["class","col s3 message-left",4,"ngIf"],["class","col s9 message-right",4,"ngIf"],["class","col s12",4,"ngIf"],[1,"progress"],[1,"indeterminate"],[1,"col","s3","message-left"],["class","message",3,"ngClass","routerLink",4,"ngFor","ngForOf"],[1,"message",3,"ngClass","routerLink"],["href","javascript:;",3,"click"],[1,"fa","fa-times","right"],["class","truncate",3,"innerHTML",4,"ngIf"],["class","msg-cont truncate",3,"innerHTML",4,"ngIf"],[1,"message-date"],[1,"truncate",3,"innerHTML"],[1,"msg-cont","truncate",3,"innerHTML"],[1,"col","s9","message-right"],[4,"ngIf"],[3,"innerHTML",4,"ngIf"],[3,"innerHTML"],[1,"col","s12"],["type","error","icon","fa fa-exclamation-circle",3,"content"]],template:function(e,s){1&e&&(d.TgZ(0,"div",0),d.TgZ(1,"div",1),d.TgZ(2,"div",2),d.TgZ(3,"div",3),d.TgZ(4,"span",4),d._uU(5),d.ALo(6,"translate"),d.qZA(),d.qZA(),d.TgZ(7,"div",5),d.YNc(8,f,2,0,"div",6),d.YNc(9,A,2,1,"div",7),d.YNc(10,x,2,1,"div",8),d.YNc(11,J,3,3,"div",9),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&e&&(d.xp6(5),d.hij(" ",d.lcZ(6,5,"TEXTS.MESSAGES")," "),d.xp6(3),d.Q6J("ngIf",s.inProgress),d.xp6(1),d.Q6J("ngIf",!!s.messageList&&s.messageList.length),d.xp6(1),d.Q6J("ngIf",!!s.messageList&&s.messageList.length),d.xp6(1),d.Q6J("ngIf",!s.inProgress&&!!s.messageList&&!s.messageList.length))},directives:[l.O5,l.sg,l.mk,m.rH,u.W],pipes:[h.X$,l.uU,i.pEp,i.zXP],encapsulation:2});const k=[{path:"",pathMatch:"full",canActivate:[i.$Tg],component:S,data:{name:"messages"}},{path:"",canActivate:[i.$Tg],children:[{path:":msgId",component:S,data:{name:"message-detail"}}]}],H=m.Bz.forChild(k);class Q{}Q.\u0275fac=function(e){return new(e||Q)},Q.\u0275mod=d.oAB({type:Q}),Q.\u0275inj=d.cJS({providers:[l.uU],imports:[[H,n.m]]})}}]);